"use strict";(self.webpackChunkanimespring=self.webpackChunkanimespring||[]).push([[167],{167:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var d=t(9379),r=t(5043),i=t(2407),a=t(6471),l=t(579);const c=e=>{let{statusFilter:s,readOnly:t=!1}=e;const[c,n]=(0,r.useState)([]),[o,h]=(0,r.useState)([]),[u,p]=(0,r.useState)(!0),x=(0,i.xI)(),[j,m]=(0,r.useState)(null),{showOrderStatusNotification:g,showOrderCancellationNotification:v,updateOrders:f}=(0,a.hN)();(0,r.useEffect)(()=>{const e=x.onAuthStateChanged(e=>{m(e)});return()=>e()},[x]),(0,r.useEffect)(()=>{j?(N(j.uid),b()):(n([]),p(!1))},[j,s]),(0,r.useEffect)(()=>{c.length>0&&f(c)},[c,f]);const N=async(e,t)=>{try{let d="http://localhost:5000/api/orders?userId=".concat(e);const r=await fetch(d),i=await r.json();let a=i;if(t)a="delivered"===t?i.filter(e=>"delivered"===e.status):"canceled"===t?i.filter(e=>"canceled"===e.status):i;else if(s)if("history"===s){const e=["canceled","delivered"];a=i.filter(s=>e.includes(s.status))}else a="canceled"===s?i.filter(e=>"canceled"===e.status):"delivered"===s?i.filter(e=>"delivered"===e.status):i.filter(e=>e.status===s);else a=i.filter(e=>"canceled"!==e.status&&"delivered"!==e.status);n(a),p(!1)}catch(d){console.error("Error fetching user orders:",d),p(!1)}},b=async()=>{try{const e=await fetch("http://localhost:5000/api/products"),s=await e.json();h(s)}catch(e){console.error("Error fetching products:",e)}},y=e=>o.find(s=>s.id===e);return j?u?(0,l.jsx)("p",{children:"Loading your orders..."}):0===c.length?(0,l.jsx)("p",{children:"You have no orders."}):(0,l.jsxs)("div",{className:"profile-section orders-section",children:[(0,l.jsxs)("h1",{children:["returned"===s&&"My Returns","canceled"===s&&"My Cancellations","history"===s&&"Order History",!s&&"My Orders"]}),(0,l.jsxs)("div",{className:"filter-container",children:[(0,l.jsx)("label",{htmlFor:"orderFilter",children:"Filter Orders: "}),(0,l.jsxs)("select",{id:"orderFilter",onChange:e=>{const s=e.target.value;"dateAsc"===s?n(e=>[...e].sort((e,s)=>new Date(e.orderDate)-new Date(s.orderDate))):"dateDesc"===s?n(e=>[...e].sort((e,s)=>new Date(s.orderDate)-new Date(e.orderDate))):"delivered"===s?N(j.uid,"delivered"):"canceled"===s?N(j.uid,"canceled"):N(j.uid)},children:[(0,l.jsx)("option",{value:"all",children:"All"}),(0,l.jsx)("option",{value:"delivered",children:"Delivered"}),(0,l.jsx)("option",{value:"canceled",children:"Canceled"}),(0,l.jsx)("option",{value:"dateAsc",children:"Date Ascending"}),(0,l.jsx)("option",{value:"dateDesc",children:"Date Descending"})]})]}),(0,l.jsx)("div",{className:"orders-table-container",children:(0,l.jsxs)("table",{className:"orders-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{"data-label":"Products",children:"Products"}),(0,l.jsx)("th",{"data-label":"Shipping Details",children:"Shipping Details"}),(0,l.jsx)("th",{"data-label":"Order ID",children:"Order ID"}),(0,l.jsx)("th",{"data-label":"Status",children:"Status"}),(0,l.jsx)("th",{"data-label":"Items & Total",children:"Items & Total"}),(0,l.jsx)("th",{"data-label":"Payment Method",children:"Payment Method"}),(0,l.jsx)("th",{"data-label":"Actions",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:c.map(e=>(0,l.jsxs)("tr",{className:"order-table-row beautiful-row ".concat("canceled"===e.status?"canceled-row":""," ").concat("delivered"===e.status?"delivered-row":""),children:[(0,l.jsx)("td",{"data-label":"Products",children:(0,l.jsx)("ul",{className:"product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=y(e.id);return s?(0,l.jsxs)("li",{className:"product-list-item",children:[(0,l.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,l.jsxs)("div",{className:"product-info",children:[(0,l.jsx)("div",{className:"product-name",children:s.name}),(0,l.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,l.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,l.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,l.jsxs)("div",{className:"product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,l.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=y(e);return s?(0,l.jsxs)("li",{className:"product-list-item",children:[(0,l.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,l.jsxs)("div",{className:"product-info",children:[(0,l.jsx)("div",{className:"product-name",children:s.name}),(0,l.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,l.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,l.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,l.jsx)("div",{className:"product-quantity",children:"Quantity: 1"})]})]},e):(0,l.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,l.jsx)("li",{children:"No products found"})})}),(0,l.jsx)("td",{"data-label":"Shipping Details",children:e.shippingAddress?(0,l.jsxs)("div",{className:"shipping-details",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,l.jsx)("div",{children:"No shipping details available."})}),(0,l.jsx)("td",{"data-label":"Order ID",children:e.id}),(0,l.jsx)("td",{"data-label":"Status",children:e.status}),(0,l.jsx)("td",{"data-label":"Items & Total",children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var t;return e+(s.quantity||1)*((null===(t=y(s.id))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var t;return e+((null===(t=y(s))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,l.jsx)("td",{"data-label":"Payment Method",children:e.paymentMethod||"N/A"}),(0,l.jsx)("td",{"data-label":"Actions",children:t||"processing"!==e.status?"canceled"===e.status?(0,l.jsx)("span",{className:"status-canceled",children:"Order Canceled"}):(0,l.jsxs)("span",{className:"status-delivered",children:["Order ",e.status.charAt(0).toUpperCase()+e.status.slice(1)]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("button",{className:"btn-cancel beautiful-btn",onClick:()=>(async e=>{try{(await fetch("http://localhost:5000/api/orders/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"canceled"})})).ok?(n(s=>s.map(s=>s.id===e?(0,d.A)((0,d.A)({},s),{},{status:"canceled"}):s)),v(e)):console.error("Failed to cancel order")}catch(s){console.error("Error canceling order:",s)}})(e.id),children:"Cancel Order"})})})]},e.id))})]})})]}):(0,l.jsx)("p",{children:"Please log in to view your orders."})}}}]);
//# sourceMappingURL=167.eb6ab1ff.chunk.js.map