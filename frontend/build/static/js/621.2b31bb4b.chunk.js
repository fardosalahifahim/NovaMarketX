"use strict";(self.webpackChunkanimespring=self.webpackChunkanimespring||[]).push([[621],{6621:(e,s,t)=>{t.r(s),t.d(s,{default:()=>M});var r=t(9379),a=t(5043),i=t(9722),n=t(579);const d=e=>{let{activeSection:s,onSectionChange:t,onLogout:r,onOrderFilterChange:i}=e;const[d,l]=(0,a.useState)("orders");return(0,n.jsxs)("nav",{className:"admin-nav-bar",children:[(0,n.jsx)("ul",{style:{display:"flex",flexDirection:"column"},children:[{label:"Dashboard",value:"dashboard"},{label:"Product List",value:"products"},{label:"User Data",value:"users"},{label:"Orders",value:"orders"},{label:"Canceled Orders",value:"cancelorder"},{label:"History",value:"orderhistory"},{label:"Delivered Orders",value:"deliveredorders"},{label:"Confirmed Orders",value:"confirmedOrders"},{label:"Shipped Orders",value:"shippedOrders"},{label:"Messages",value:"messages"},{label:"Update",value:"update"}].map((e,r)=>(0,n.jsx)("li",{className:s===e.value?"active":"",onClick:()=>t(e.value),style:{order:r},children:e.label},r))}),(0,n.jsx)("div",{className:"admin-nav-bar-logout",children:(0,n.jsx)("button",{onClick:r,children:"Logout"})})]})},l=()=>{const[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)([]),[d,l]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null),[u,h]=(0,a.useState)(""),p="animespring";(0,a.useEffect)(()=>{m()},[]),(0,a.useEffect)(()=>{console.log("Connecting to SSE endpoint as admin");const e=new EventSource("http://localhost:5000/api/messages/stream?isAdmin=true");e.onopen=()=>{console.log("SSE connection opened")},e.onmessage=e=>{try{const t=JSON.parse(e.data);console.log("Received SSE data:",t),Array.isArray(t)?(s(t),l(!1),console.log("Initial messages loaded:",t.length)):(s(e=>e.find(e=>e.id===t.id)?e:[...e,t]),console.log("New message received:",t))}catch(t){console.error("Error parsing SSE message:",t)}},e.onerror=s=>{console.error("EventSource failed:",s),e.close(),l(!1)};const t=setTimeout(()=>{console.log("SSE timeout reached, stopping loading"),l(!1)},5e3);return()=>{console.log("Closing SSE connection"),e.close(),clearTimeout(t)}},[]);const m=async()=>{try{const e=await i.A.get("http://localhost:5000/api/users");r(e.data),e.data.length>0&&o(e.data[0].id)}catch(e){console.error("Error fetching users:",e)}},x=e=>{const s=t.find(s=>s.id===e);return s?s.username:"Unknown User"},j={};e.forEach(e=>{const s=e.senderId===p?e.receiverId:e.senderId;j[s]=e});const g=c?e.filter(e=>e.senderId===p&&e.receiverId===c||e.senderId===c&&e.receiverId===p):[];return(0,n.jsxs)("div",{className:"admin-messages-container",children:[(0,n.jsxs)("div",{className:"sidebar",children:[(0,n.jsx)("h2",{children:"Users"}),(0,n.jsx)("ul",{className:"user-list",children:t.map(e=>{const s=j[e.id];return(0,n.jsxs)("li",{className:"user-item ".concat(c===e.id?"selected":""),onClick:()=>{return s=e.id,void o(s);var s},children:[(0,n.jsx)("div",{className:"user-avatar",children:e.username.charAt(0).toUpperCase()}),(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsx)("div",{className:"user-name",children:x(e.id)}),(0,n.jsx)("div",{className:"user-last-message",children:s?s.content:"No messages yet"})]})]},e.id)})})]}),(0,n.jsxs)("div",{className:"chat-window",children:[(0,n.jsx)("div",{className:"chat-header",children:c?x(c):"Select a user"}),(0,n.jsx)("div",{className:"chat-messages",children:d?(0,n.jsx)("p",{children:"Loading messages..."}):c&&0===g.length?(0,n.jsx)("p",{children:"No messages found for this user."}):c?g.map(e=>(0,n.jsxs)("div",{className:"chat-message",children:[(0,n.jsx)("div",{className:"message-content",children:e.content}),(0,n.jsx)("div",{className:"message-timestamp",children:new Date(e.timestamp).toLocaleString()})]},e.id)):e.length>0?(0,n.jsx)("p",{children:"Please select a user to view messages."}):(0,n.jsx)("p",{children:"No messages available. Please select a user and send a message."})}),(0,n.jsxs)("div",{className:"chat-input",children:[(0,n.jsx)("textarea",{placeholder:"Type your message...",value:u,onChange:e=>h(e.target.value),disabled:!c}),(0,n.jsx)("button",{onClick:async()=>{if(u.trim()&&c)try{await i.A.post("http://localhost:5000/api/faq-messages",{content:u.trim(),senderId:p,receiverId:c}),h(""),(async e=>{l(!0);try{const t=await i.A.get("http://localhost:5000/api/messages?userId=".concat(e));s(t.data)}catch(t){console.error("Error fetching messages:",t)}finally{l(!1)}})(c)}catch(e){console.error("Error sending message:",e)}},disabled:!c,children:"Send"})]})]})]})},c=e=>{let{orders:s,products:t=[],users:i=[],onDeleteOrder:d,isProfileOrders:l}=e;console.log("Orders component received users:",i),console.log("Orders component received orders:",s),console.log("Users data loaded from import:",i);const[c,o]=(0,a.useState)(""),[u,h]=(0,a.useState)("orderId"),[p,m]=(0,a.useState)("all"),x=e=>t&&0!==t.length?t.find(s=>s.id===e):null;let j=s.filter(e=>{const s=c.toLowerCase();if("canceled"===p&&"canceled"!==e.status.toLowerCase())return!1;if("history"===p&&!["canceled","delivered"].includes(e.status.toLowerCase()))return!1;if("delivered"===p&&"delivered"!==e.status.toLowerCase())return!1;switch(u){case"orderId":return e.id.toString().toLowerCase().includes(s);case"userId":return e.userId.toString().toLowerCase().includes(s);case"productId":return e.productIds&&e.productIds.some(e=>e.toString().toLowerCase().includes(s));case"phoneNumber":return e.shippingAddress&&e.shippingAddress.phoneNumber&&e.shippingAddress.phoneNumber.toLowerCase().includes(s);case"status":return e.status&&e.status.toLowerCase().includes(s);default:return!0}});const g=new Map;j.forEach(e=>{g.has(e.id)||g.set(e.id,e)}),j=Array.from(g.values());const[v,y]=(0,a.useState)(s.reduce((e,s)=>(e[s.id]=s.status,e),{})),N=async(e,s)=>{try{console.log("Updating order ".concat(e," status to ").concat(s));const t=await fetch("http://localhost:5000/api/orders/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})});if(!t.ok){const e=await t.text();throw console.error("Failed to update order status:",t.status,e),new Error("Failed to update order status: ".concat(t.status," ").concat(e))}y(t=>(0,r.A)((0,r.A)({},t),{},{[e]:s})),"function"===typeof onOrderStatusChange&&onOrderStatusChange()}catch(t){console.error("Error updating order status:",t),alert("Failed to update order status")}};return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{id:"orders",children:l?"Profile Orders":"Orders"}),(0,n.jsxs)("div",{style:{marginBottom:"20px",padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"5px"},children:[(0,n.jsx)("strong",{children:"Debug Info:"}),(0,n.jsxs)("div",{children:["Users loaded: ",i?i.length:0]}),(0,n.jsxs)("div",{children:["Orders loaded: ",s?s.length:0]}),(0,n.jsxs)("div",{children:["Processing orders: ",s?s.filter(e=>"pending"===e.status.toLowerCase()||"processing"===e.status.toLowerCase()).length:0]})]}),(0,n.jsxs)("div",{className:"order-search-container",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search orders",value:c,onChange:e=>o(e.target.value),className:"order-search-input"}),(0,n.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"order-search-select",children:[(0,n.jsx)("option",{value:"orderId",children:"Order ID"}),(0,n.jsx)("option",{value:"userId",children:"User ID"}),(0,n.jsx)("option",{value:"productId",children:"Product ID"}),(0,n.jsx)("option",{value:"phoneNumber",children:"Phone Number"}),(0,n.jsx)("option",{value:"status",children:"Status"})]}),(0,n.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"order-status-filter",style:{marginLeft:"10px"},children:[(0,n.jsx)("option",{value:"all",children:"All"}),(0,n.jsx)("option",{value:"canceled",children:"Canceled"}),(0,n.jsx)("option",{value:"history",children:"History"}),(0,n.jsx)("option",{value:"delivered",children:"Delivered"})]})]}),0===j.length?(0,n.jsx)("p",{children:"No orders found."}):(0,n.jsxs)("table",{className:"orders-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Products"}),(0,n.jsx)("th",{children:"Shipping Details"}),(0,n.jsx)("th",{children:"Order ID"}),(0,n.jsx)("th",{children:"User ID"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Quantity"}),(0,n.jsx)("th",{children:"Payment Method"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:j.map(e=>(0,n.jsxs)("tr",{className:"order-table-row",children:[(0,n.jsx)("td",{children:(0,n.jsx)("ul",{className:"product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=x(e.id);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,n.jsxs)("div",{className:"product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,n.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=x(e);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,n.jsx)("div",{className:"product-quantity",children:"Quantity: 1"})]})]},e):(0,n.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,n.jsx)("li",{children:"No products found"})})}),(0,n.jsx)("td",{children:e.shippingAddress?(0,n.jsxs)("div",{className:"shipping-details",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,n.jsx)("div",{children:"No shipping details available."})}),(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"User ID:"})," ",e.userId]}),(s=>{const t=(e=>{if(!i||0===i.length)return console.log("Users data array is empty or null"),null;console.log("Looking for user with ID/UID:",e,"Type:",typeof e),console.log("Available users count:",i.length),console.log("Available UIDs:",i.map(e=>e.uid).filter(Boolean));let s=null;return s=i.find(s=>s.uid===e),s||(s=i.find(s=>String(s.id)===String(e))),s||(s=i.find(s=>s.uid&&s.uid.toLowerCase()===String(e).toLowerCase()),s&&console.log("User found by case-insensitive UID match:",e)),s||(s=i.find(s=>s.uid&&s.uid.startsWith(e.substring(0,10))),s&&console.log("User found by partial UID match:",e)),s?console.log("Successfully found user:",{id:s.id,uid:s.uid,username:s.username,email:s.email,phone:s.phone}):(console.log("No user found with ID/UID:",e),console.log("Available user IDs:",i.map(e=>e.id)),console.log("Available UIDs:",i.map(e=>e.uid).filter(Boolean))),s})(e.userId);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Username:"})," ",e.userUsername||(null===t||void 0===t?void 0:t.username)||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Email:"})," ",e.userEmail||(null===t||void 0===t?void 0:t.email)||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone (User):"})," ",e.userPhoneUser||(null===t||void 0===t?void 0:t.phone)||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone (Shipping):"})," ",e.userPhoneShipping||(null===(s=e.shippingAddress)||void 0===s?void 0:s.phoneNumber)||"N/A"]})]})})()]})}),(0,n.jsx)("td",{children:v[e.id]}),(0,n.jsx)("td",{children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var t;return e+(s.quantity||1)*((null===(t=x(s.id))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var t;return e+((null===(t=x(s))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,n.jsx)("td",{children:e.paymentMethod||"N/A"}),(0,n.jsxs)("td",{children:[!l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"btn-confirm",onClick:()=>(e=>{const s=document.createElement("div");s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100vw",s.style.height="100vh",s.style.backgroundColor="rgba(0,0,0,0.6)",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.zIndex="10000";const t=document.createElement("div");t.style.backgroundColor="#fefefe",t.style.padding="30px 40px",t.style.borderRadius="12px",t.style.boxShadow="0 8px 24px rgba(0,0,0,0.3)",t.style.textAlign="center",t.style.minWidth="320px",t.style.fontFamily="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";const r=document.createElement("p");r.textContent="Are you sure you want to confirm this order?",r.style.fontSize="18px",r.style.marginBottom="25px",r.style.color="#333";const a=document.createElement("button");a.textContent="Confirm",a.style.margin="0 15px",a.style.padding="10px 25px",a.style.border="none",a.style.borderRadius="6px",a.style.backgroundColor="#4CAF50",a.style.color="white",a.style.fontWeight="600",a.style.cursor="pointer",a.style.fontSize="16px",a.style.boxShadow="0 4px 10px rgba(76, 175, 80, 0.4)",a.onmouseover=()=>a.style.backgroundColor="#45a049",a.onmouseout=()=>a.style.backgroundColor="#4CAF50",a.onclick=()=>{N(e,"confirmed"),document.body.removeChild(s)};const i=document.createElement("button");i.textContent="Cancel",i.style.margin="0 15px",i.style.padding="10px 25px",i.style.border="none",i.style.borderRadius="6px",i.style.backgroundColor="#f44336",i.style.color="white",i.style.fontWeight="600",i.style.cursor="pointer",i.style.fontSize="16px",i.style.boxShadow="0 4px 10px rgba(244, 67, 54, 0.4)",i.onmouseover=()=>i.style.backgroundColor="#da190b",i.onmouseout=()=>i.style.backgroundColor="#f44336",i.onclick=()=>{document.body.removeChild(s)},t.appendChild(r),t.appendChild(a),t.appendChild(i),s.appendChild(t),document.body.appendChild(s)})(e.id),children:"Confirm"}),(0,n.jsx)("button",{className:"btn-cancel",onClick:()=>(async e=>{if(l&&"confirmed"===v[e])return void alert("Confirmed orders cannot be canceled.");const s=document.createElement("div");s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100vw",s.style.height="100vh",s.style.backgroundColor="rgba(0,0,0,0.6)",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.zIndex="10000";const t=document.createElement("div");t.style.backgroundColor="#fefefe",t.style.padding="30px 40px",t.style.borderRadius="12px",t.style.boxShadow="0 8px 24px rgba(0,0,0,0.3)",t.style.textAlign="center",t.style.minWidth="320px",t.style.fontFamily="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";const r=document.createElement("p");r.textContent="Are you sure you want to cancel this order?",r.style.fontSize="18px",r.style.marginBottom="25px",r.style.color="#333";const a=document.createElement("button");a.textContent="Cancel Order",a.style.margin="0 15px",a.style.padding="10px 25px",a.style.border="none",a.style.borderRadius="6px",a.style.backgroundColor="#f44336",a.style.color="white",a.style.fontWeight="600",a.style.cursor="pointer",a.style.fontSize="16px",a.style.boxShadow="0 4px 10px rgba(244, 67, 54, 0.4)",a.onmouseover=()=>a.style.backgroundColor="#da190b",a.onmouseout=()=>a.style.backgroundColor="#f44336",a.onclick=async()=>{try{await N(e,"canceled"),console.log("Order ".concat(e," canceled successfully")),"function"===typeof onOrderStatusChange&&onOrderStatusChange()}catch(t){console.error("Failed to cancel order ".concat(e,":"),t),alert("Failed to cancel order")}document.body.removeChild(s)};const i=document.createElement("button");i.textContent="Keep Order",i.style.margin="0 15px",i.style.padding="10px 25px",i.style.border="none",i.style.borderRadius="6px",i.style.backgroundColor="#4CAF50",i.style.color="white",i.style.fontWeight="600",i.style.cursor="pointer",i.style.fontSize="16px",i.style.boxShadow="0 4px 10px rgba(76, 175, 80, 0.4)",i.onmouseover=()=>i.style.backgroundColor="#45a049",i.onmouseout=()=>i.style.backgroundColor="#4CAF50",i.onclick=()=>{document.body.removeChild(s)},t.appendChild(r),t.appendChild(a),t.appendChild(i),s.appendChild(t),document.body.appendChild(s)})(e.id),children:"Cancel"})]}),l&&(0,n.jsx)(n.Fragment,{})]})]},e.id))})]})]})};var o=t(2407);const u=e=>{let{statusFilter:s,readOnly:t=!1,isAdmin:i=!1}=e;const[d,l]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),m=(0,o.xI)(),[x,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=m.onAuthStateChanged(e=>{j(e)});return()=>e()},[m]),(0,a.useEffect)(()=>{i||x?(g(null===x||void 0===x?void 0:x.uid),v()):(l([]),p(!1))},[x,s,i]);const g=async(e,t)=>{try{let r=i?"http://localhost:5000/api/orders":"http://localhost:5000/api/orders?userId=".concat(e);const a=await fetch(r),n=await a.json();let d=n;if(i)d=n.filter(e=>["canceled","delivered"].includes(e.status));else if(t)d="delivered"===t?n.filter(e=>"delivered"===e.status):"canceled"===t?n.filter(e=>"canceled"===e.status):n;else if(s)if("history"===s){const e=["canceled","delivered"];d=n.filter(s=>e.includes(s.status))}else d="canceled"===s?n.filter(e=>"canceled"===e.status):"delivered"===s?n.filter(e=>"delivered"===e.status):n.filter(e=>e.status===s);else d=n.filter(e=>"canceled"!==e.status&&"delivered"!==e.status);l(d),p(!1)}catch(r){console.error("Error fetching orders:",r),p(!1)}},v=async()=>{try{const e=await fetch("http://localhost:5000/api/products"),s=await e.json();u(s)}catch(e){console.error("Error fetching products:",e)}},y=e=>c.find(s=>s.id===e);return i||x?h?(0,n.jsx)("p",{children:"Loading your orders..."}):0===d.length?(0,n.jsx)("p",{children:"You have no orders."}):(0,n.jsxs)("div",{className:"profile-section admin-orders-section",children:[(0,n.jsx)("h1",{children:i?"Admin Order History":(0,n.jsxs)(n.Fragment,{children:["returned"===s&&"My Returns","canceled"===s&&"My Cancellations","history"===s&&"Order History",!s&&"My Orders"]})}),(0,n.jsxs)("div",{className:"admin-filter-container",children:[(0,n.jsx)("label",{htmlFor:"orderFilter",children:"Filter Orders: "}),(0,n.jsxs)("select",{id:"orderFilter",onChange:e=>{const s=e.target.value;"dateAsc"===s?l(e=>[...e].sort((e,s)=>new Date(e.orderDate)-new Date(s.orderDate))):"dateDesc"===s?l(e=>[...e].sort((e,s)=>new Date(s.orderDate)-new Date(e.orderDate))):"delivered"===s?g(i?null:x.uid,"delivered"):"canceled"===s?g(i?null:x.uid,"canceled"):g(i?null:x.uid)},children:[(0,n.jsx)("option",{value:"all",children:"All"}),(0,n.jsx)("option",{value:"delivered",children:"Delivered"}),(0,n.jsx)("option",{value:"canceled",children:"Canceled"}),(0,n.jsx)("option",{value:"dateAsc",children:"Date Ascending"}),(0,n.jsx)("option",{value:"dateDesc",children:"Date Descending"})]})]}),(0,n.jsx)("div",{className:"admin-orders-table-container",children:(0,n.jsxs)("table",{className:"admin-orders-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{"data-label":"Products",children:"Products"}),(0,n.jsx)("th",{"data-label":"Shipping Details",children:"Shipping Details"}),(0,n.jsx)("th",{"data-label":"Order ID",children:"Order ID"}),(0,n.jsx)("th",{"data-label":"Status",children:"Status"}),(0,n.jsx)("th",{"data-label":"Items & Total",children:"Items & Total"}),(0,n.jsx)("th",{"data-label":"Payment Method",children:"Payment Method"}),(0,n.jsx)("th",{"data-label":"Actions",children:"Actions"})]})}),(0,n.jsx)("tbody",{children:d.map(e=>(0,n.jsxs)("tr",{className:"admin-order-table-row admin-beautiful-row ".concat("canceled"===e.status?"admin-canceled-row":""," ").concat("delivered"===e.status?"admin-delivered-row":""),children:[(0,n.jsx)("td",{"data-label":"Products",children:(0,n.jsx)("ul",{className:"admin-product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=y(e.id);return s?(0,n.jsxs)("li",{className:"admin-product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"admin-product-image"}),(0,n.jsxs)("div",{className:"admin-product-info",children:[(0,n.jsx)("div",{className:"admin-product-name",children:s.name}),(0,n.jsxs)("div",{className:"admin-product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"admin-product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,n.jsxs)("div",{className:"admin-product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,n.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=y(e);return s?(0,n.jsxs)("li",{className:"admin-product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"admin-product-image"}),(0,n.jsxs)("div",{className:"admin-product-info",children:[(0,n.jsx)("div",{className:"admin-product-name",children:s.name}),(0,n.jsxs)("div",{className:"admin-product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"admin-product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,n.jsx)("div",{className:"admin-product-quantity",children:"Quantity: 1"})]})]},e):(0,n.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,n.jsx)("li",{children:"No products found"})})}),(0,n.jsx)("td",{"data-label":"Shipping Details",children:e.shippingAddress?(0,n.jsxs)("div",{className:"admin-shipping-details",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,n.jsx)("div",{children:"No shipping details available."})}),(0,n.jsx)("td",{"data-label":"Order ID",children:e.id}),(0,n.jsx)("td",{"data-label":"Status",children:e.status}),(0,n.jsx)("td",{"data-label":"Items & Total",children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var t;return e+(s.quantity||1)*((null===(t=y(s.id))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var t;return e+((null===(t=y(s))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,n.jsx)("td",{"data-label":"Payment Method",children:e.paymentMethod||"N/A"}),(0,n.jsx)("td",{"data-label":"Actions",children:t||"processing"!==e.status?"canceled"===e.status?(0,n.jsx)("span",{className:"admin-status-canceled",children:"Order Canceled"}):(0,n.jsxs)("span",{className:"admin-status-delivered",children:["Order ",e.status.charAt(0).toUpperCase()+e.status.slice(1)]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("button",{className:"admin-btn-cancel admin-beautiful-btn",onClick:()=>(async e=>{try{(await fetch("http://localhost:5000/api/orders/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"canceled"})})).ok?l(s=>s.map(s=>s.id===e?(0,r.A)((0,r.A)({},s),{},{status:"canceled"}):s)):console.error("Failed to cancel order")}catch(s){console.error("Error canceling order:",s)}})(e.id),children:"Cancel Order"})})})]},e.id))})]})})]}):(0,n.jsx)("p",{children:"Please log in to view your orders."})},h=e=>{let{orders:s,products:t,users:r,onDeleteOrder:a}=e;return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Cancelled Orders"}),0===s.length?(0,n.jsx)("p",{children:"No canceled orders found."}):(0,n.jsxs)("table",{className:"orders-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Products"}),(0,n.jsx)("th",{children:"Shipping Details"}),(0,n.jsx)("th",{children:"Order ID"}),(0,n.jsx)("th",{children:"User ID"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Quantity"})]})}),(0,n.jsx)("tbody",{children:s.map(e=>(0,n.jsxs)("tr",{className:"order-table-row",children:[(0,n.jsx)("td",{children:(0,n.jsx)("ul",{className:"product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=t.find(s=>s.id===e.id);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,n.jsxs)("div",{className:"product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,n.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=t.find(s=>s.id===e);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,n.jsx)("div",{className:"product-quantity",children:"Quantity: 1"})]})]},e):(0,n.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,n.jsx)("li",{children:"No products found"})})}),(0,n.jsx)("td",{children:e.shippingAddress?(0,n.jsxs)("div",{className:"shipping-details",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,n.jsx)("div",{children:"No shipping details available."})}),(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"User ID:"})," ",e.userId]}),(()=>{const s=(t=e.userId,r&&0!==r.length?r.find(e=>e.uid===t):null);var t;return s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Email:"})," ",s.email||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone:"})," ",s.phone||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Username:"})," ",s.username||"N/A"]})]}):(0,n.jsx)("div",{children:"User details not found"})})()]})}),(0,n.jsx)("td",{children:e.status}),(0,n.jsx)("td",{children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var r;return e+(s.quantity||1)*((null===(r=t.find(e=>e.id===s.id))||void 0===r?void 0:r.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var r;return e+((null===(r=t.find(e=>e.id===s))||void 0===r?void 0:r.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,n.jsx)("td",{})]},e.id))})]})]})},p=e=>{let{products:s,orders:t,refreshOrders:r}=e;const a=e=>s&&0!==s.length?s.find(s=>s.id===e):null;return t?0===t.length?(0,n.jsx)("p",{children:"No delivered orders found."}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Delivered Orders"}),(0,n.jsxs)("table",{className:"orders-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Products"}),(0,n.jsx)("th",{children:"Shipping Details"}),(0,n.jsx)("th",{children:"Order ID"}),(0,n.jsx)("th",{children:"User ID"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Quantity"}),(0,n.jsx)("th",{children:"Payment Method"})]})}),(0,n.jsx)("tbody",{children:t.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("ul",{className:"product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=a(e.id);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,n.jsxs)("div",{className:"product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,n.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=a(e);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,n.jsx)("div",{className:"product-quantity",children:"Quantity: 1"})]})]},e):(0,n.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,n.jsx)("li",{children:"No products found"})})}),(0,n.jsx)("td",{children:e.shippingAddress?(0,n.jsxs)("div",{className:"shipping-details",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,n.jsx)("div",{children:"No shipping address"})}),(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:e.userId}),(0,n.jsx)("td",{children:e.status}),(0,n.jsx)("td",{children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var t;return e+(s.quantity||1)*((null===(t=a(s.id))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var t;return e+((null===(t=a(s))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,n.jsx)("td",{children:e.paymentMethod||"N/A"})]},e.id))})]})]}):(0,n.jsx)("p",{children:"Loading delivered orders..."})},m=e=>{let{products:s,users:t}=e;const[r,i]=(0,a.useState)([]),[d,l]=(0,a.useState)(!0),[c,o]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{p()},[]);const p=async()=>{try{const e=await fetch("http://localhost:5000/api/orders"),s=(await e.json()).filter(e=>"confirmed"===e.status);i(s),l(!1)}catch(e){console.error("Error fetching confirmed orders:",e),l(!1)}},m=e=>s&&0!==s.length?s.find(s=>s.id===e):null,x=async(e,s)=>{try{const t=await fetch("http://localhost:5000/api/orders/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})});if(!t.ok){const e=await t.text();throw console.error("Failed to update order status:",t.status,e),new Error("Failed to update order status: ".concat(t.status," ").concat(e))}p()}catch(t){console.error("Error updating order status:",t),alert("Failed to update order status")}},j=()=>{h(null),o(!1)};return d?(0,n.jsx)("p",{children:"Loading confirmed orders..."}):0===r.length?(0,n.jsx)("p",{children:"No confirmed orders found."}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Confirmed Orders"}),(0,n.jsxs)("table",{className:"orders-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Products"}),(0,n.jsx)("th",{children:"Shipping Details"}),(0,n.jsx)("th",{children:"Order ID"}),(0,n.jsx)("th",{children:"User ID"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Price"}),(0,n.jsx)("th",{children:"Payment Method"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:r.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("ul",{className:"product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=m(e.id);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,n.jsxs)("div",{className:"product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,n.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=m(e);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,n.jsx)("div",{className:"product-quantity",children:"Quantity: 1"})]})]},e):(0,n.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,n.jsx)("li",{children:"No products found"})})}),(0,n.jsx)("td",{children:e.shippingAddress?(0,n.jsxs)("div",{className:"shipping-details",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,n.jsx)("div",{children:"No shipping address"})}),(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"User ID:"})," ",e.userId]}),(()=>{const s=(r=e.userId,t&&0!==t.length?t.find(e=>e.id===r):null);var r;return s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Email:"})," ",s.email||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone:"})," ",s.phone||"N/A"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Username:"})," ",s.username||"N/A"]})]}):(0,n.jsx)("div",{children:"User details not found"})})()]})}),(0,n.jsx)("td",{children:e.status}),(0,n.jsx)("td",{children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var t;return e+(s.quantity||1)*((null===(t=m(s.id))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var t;return e+((null===(t=m(s))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,n.jsx)("td",{children:e.paymentMethod||"N/A"}),(0,n.jsxs)("td",{children:[(0,n.jsx)("button",{className:"btn-cancel",onClick:()=>{return s=e.id,void(window.confirm("Are you sure you want to cancel this order?")&&x(s,"canceled"));var s},children:"Cancel"}),(0,n.jsx)("button",{className:"btn-shipped beautiful-btn enhanced-btn",onClick:()=>{return s=e.id,h(s),void o(!0);var s},children:"Shipped"})]})]},e.id))})]}),c&&(0,n.jsx)("div",{className:"modal-overlay beautiful-modal-overlay",children:(0,n.jsxs)("div",{className:"modal-content beautiful-modal-content",children:[(0,n.jsx)("h3",{children:"Confirm Shipping"}),(0,n.jsx)("p",{children:"Are you sure you want to mark this order as shipped?"}),(0,n.jsxs)("div",{className:"modal-buttons",children:[(0,n.jsx)("button",{className:"btn-confirm beautiful-btn-confirm",onClick:()=>{u&&(x(u,"shipping"),j())},children:"Yes"}),(0,n.jsx)("button",{className:"btn-cancel beautiful-btn-cancel",onClick:j,children:"No"})]})]})})]})},x=e=>{let{products:s,onOrderStatusChange:t}=e;const[r,i]=(0,a.useState)([]),[d,l]=(0,a.useState)(!0),[c,o]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),[p,m]=(0,a.useState)(null),[x,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{g()},[]);const g=async()=>{try{const e=await fetch("http://localhost:5000/api/orders"),s=(await e.json()).filter(e=>"shipping"===e.status||"shipped"===e.status);i(s),l(!1)}catch(e){console.error("Error fetching shipped orders:",e),l(!1)}},v=e=>s&&0!==s.length?s.find(s=>s.id===e):null,y=async(e,s)=>{try{const r=await fetch("http://localhost:5000/api/orders/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})});if(!r.ok){const e=await r.text();throw console.error("Failed to update order status:",r.status,e),new Error("Failed to update order status: ".concat(r.status," ").concat(e))}g(),t&&t()}catch(r){console.error("Error updating order status:",r),alert("Failed to update order status")}},N=(e,s)=>{m(e),j(s),"cancel"===s?h(!0):"delivered"===s&&o(!0)},b=()=>{m(null),j(null),h(!1),o(!1)},f=()=>{p&&x&&("cancel"===x?y(p,"canceled"):"delivered"===x&&y(p,"delivered"),b())};return d?(0,n.jsx)("p",{children:"Loading shipped orders..."}):0===r.length?(0,n.jsx)("p",{children:"No shipped orders found."}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Shipped Orders"}),(0,n.jsxs)("table",{className:"orders-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Products"}),(0,n.jsx)("th",{children:"Shipping Details"}),(0,n.jsx)("th",{children:"Order ID"}),(0,n.jsx)("th",{children:"User ID"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Quantity"}),(0,n.jsx)("th",{children:"Payment Method"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:r.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("ul",{className:"product-list",children:e.productDetails&&e.productDetails.length>0?e.productDetails.map(e=>{const s=v(e.id);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(s.price*e.quantity).toFixed(2)]}),(0,n.jsxs)("div",{className:"product-quantity",children:["Quantity: ",e.quantity]})]})]},e.id):(0,n.jsxs)("li",{children:["Product ID: ",e.id," (Not found)"]},e.id)}):e.productIds&&e.productIds.length>0?e.productIds.map(e=>{const s=v(e);return s?(0,n.jsxs)("li",{className:"product-list-item",children:[(0,n.jsx)("img",{src:s.imageUrl,alt:s.name,className:"product-image"}),(0,n.jsxs)("div",{className:"product-info",children:[(0,n.jsx)("div",{className:"product-name",children:s.name}),(0,n.jsxs)("div",{className:"product-id",children:["ID: ",s.id]}),(0,n.jsxs)("div",{className:"product-price",children:["Price: $",s.price.toFixed(2)," ",(0,n.jsx)("br",{})," Total: $",(1*s.price).toFixed(2)]}),(0,n.jsx)("div",{className:"product-quantity",children:"Quantity: 1"})]})]},e):(0,n.jsxs)("li",{children:["Product ID: ",e," (Not found)"]},e)}):(0,n.jsx)("li",{children:"No products found"})})}),(0,n.jsx)("td",{children:e.shippingAddress?(0,n.jsxs)("div",{className:"shipping-details",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.shippingAddress.fullName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Phone Number:"})," ",e.shippingAddress.phoneNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Building / House No / Floor / Street:"})," ",e.shippingAddress.building]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Colony / Suburb / Locality / Landmark:"})," ",e.shippingAddress.colony]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Region:"})," ",e.shippingAddress.region]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"City:"})," ",e.shippingAddress.city]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Area:"})," ",e.shippingAddress.area]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Address:"})," ",e.shippingAddress.address]})]}):(0,n.jsx)("div",{children:"No shipping address"})}),(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:e.userId}),(0,n.jsx)("td",{children:e.status}),(0,n.jsx)("td",{children:e.productDetails?"".concat(e.productDetails.reduce((e,s)=>e+(s.quantity||1),0)," items ($").concat(e.productDetails.reduce((e,s)=>{var t;return e+(s.quantity||1)*((null===(t=v(s.id))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):e.productIds?"".concat(e.productIds.length," items ($").concat(e.productIds.reduce((e,s)=>{var t;return e+((null===(t=v(s))||void 0===t?void 0:t.price)||0)},0).toFixed(2),")"):"0 items ($0.00)"}),(0,n.jsx)("td",{children:e.paymentMethod||"N/A"}),(0,n.jsxs)("td",{children:[(0,n.jsx)("button",{className:"btn-cancel beautiful-btn",onClick:()=>N(e.id,"cancel"),children:"Cancel"}),(0,n.jsx)("button",{className:"btn-delivered beautiful-btn",onClick:()=>N(e.id,"delivered"),children:"Delivered"})]})]},e.id))})]}),u&&(0,n.jsx)("div",{className:"modal-overlay beautiful-modal-overlay",children:(0,n.jsxs)("div",{className:"modal-content beautiful-modal-content",children:[(0,n.jsx)("h3",{children:"Confirm Cancel"}),(0,n.jsx)("p",{children:"Are you sure you want to cancel this order?"}),(0,n.jsxs)("div",{className:"modal-buttons",children:[(0,n.jsx)("button",{className:"btn-confirm beautiful-btn-confirm",onClick:f,children:"Yes"}),(0,n.jsx)("button",{className:"btn-cancel beautiful-btn-cancel",onClick:b,children:"No"})]})]})}),c&&(0,n.jsx)("div",{className:"modal-overlay beautiful-modal-overlay",children:(0,n.jsxs)("div",{className:"modal-content beautiful-modal-content",children:[(0,n.jsx)("h3",{children:"Confirm Delivery"}),(0,n.jsx)("p",{children:"Are you sure you want to mark this order as delivered?"}),(0,n.jsxs)("div",{className:"modal-buttons",children:[(0,n.jsx)("button",{className:"btn-confirm beautiful-btn-confirm",onClick:f,children:"Yes"}),(0,n.jsx)("button",{className:"btn-cancel beautiful-btn-cancel",onClick:b,children:"No"})]})]})})]})};var j=t(108),g=t(5748),v=t(7734),y=t(2185),N=t(760),b=t(379),f=t(95),C=t(2310),A=t(6992),S=t(6102),P=t(7869),w=t(2291),D=t(6028);const I=e=>{let{active:s,payload:t,label:r,coordinate:a}=e;if(!s||!t||!t.length)return null;const i={position:"absolute",left:a?a.x+20:0,top:a?a.y-50:0,zIndex:9999,pointerEvents:"none"};return(0,n.jsx)("div",{className:"recharts-tooltip-wrapper",style:i,children:(0,n.jsxs)("div",{className:"custom-tooltip",children:[(0,n.jsx)("div",{className:"tooltip-header",children:(0,n.jsx)("h4",{className:"tooltip-title",children:r})}),(0,n.jsx)("div",{className:"tooltip-content",children:t.map((e,s)=>(0,n.jsxs)("div",{className:"tooltip-item",children:[(0,n.jsxs)("span",{className:"tooltip-label",children:[e.name,":"]}),(0,n.jsx)("span",{className:"tooltip-value",children:e.value})]},s))})]})})},k=["#FFBB28","#FF8042","#FFB347","#FFA07A"],F=[{label:"Last 7 Days",value:7},{label:"Last 15 Days",value:15},{label:"Last 1 Month",value:30},{label:"Last 6 Months",value:180},{label:"Last 1 Year",value:365}],U=e=>{let{products:s=[]}=e;const[t,r]=(0,a.useState)(0),[i,d]=(0,a.useState)(0),[l,c]=(0,a.useState)(0),[o,u]=(0,a.useState)(0),[h,p]=(0,a.useState)(0),[m,x]=(0,a.useState)(0),[U,E]=(0,a.useState)(0),[O,L]=(0,a.useState)(0),[T,q]=(0,a.useState)(0),[B,$]=(0,a.useState)(0),[M,R]=(0,a.useState)(0),[H,Q]=(0,a.useState)(0),[W,z]=(0,a.useState)(0),[K,V]=(0,a.useState)(0),[G,J]=(0,a.useState)([]),[Y,X]=(0,a.useState)([]),[Z,_]=(0,a.useState)(7);(0,a.useEffect)(()=>{Y.length>0&&0===G.length&&J(Y)},[Y,G]),(0,a.useEffect)(()=>{if(G.length>0){const e=G.slice(-Z);X(e)}},[Z,G]);const[ee,se]=(0,a.useState)({percent:0,change:0,target:0,revenue:0}),[te,re]=(0,a.useState)(0),[ae,ie]=(0,a.useState)(0),[ne,de]=(0,a.useState)([]),[le,ce]=(0,a.useState)([]),[oe,ue]=(0,a.useState)([]),[he,pe]=(0,a.useState)([]);(0,a.useEffect)(()=>{const e=s.length;if(0!==h){x((e-h)/h*100)}p(e)},[s]);const me=(e,s)=>0===s?0:(e-s)/s*100;(0,a.useEffect)(()=>{const e=new EventSource("http://localhost:5000/api/realtime-dashboard");return e.onmessage=e=>{const s=JSON.parse(e.data);d(t),u(l),q(O),Q(M),void 0!==s.totalSales&&r(s.totalSales),void 0!==s.totalDeliveredSales&&c(s.totalDeliveredSales),void 0!==s.totalOrders&&L(s.totalOrders),void 0!==s.totalVisitors&&R(s.totalVisitors),void 0!==s.revenueData&&X(s.revenueData),void 0!==s.monthlyTarget&&se(s.monthlyTarget),void 0!==s.activeUsers&&re(s.activeUsers),void 0!==s.activeUsersByCountry&&de(s.activeUsersByCountry),void 0!==s.conversionRateData&&ce(s.conversionRateData),void 0!==s.topCategories&&ue(s.topCategories),void 0!==s.trafficData&&pe(s.trafficData),void 0!==s.totalSales&&0!==i&&E(me(s.totalSales,i)),void 0!==s.totalDeliveredSales&&0!==o&&V(me(s.totalDeliveredSales,o)),void 0!==s.totalOrders&&0!==T&&$(me(s.totalOrders,T)),void 0!==s.totalVisitors&&0!==H&&z(me(s.totalVisitors,H)),void 0!==s.activeUsers&&0!==te&&ie(me(s.activeUsers,te)),0===s.activeUsers&&re(0)},()=>{e.close()}},[t,l,O,M,te,i,o,T,H]);const xe=ee.revenue/ee.target*100,je=Y.slice(-Z);return(0,n.jsxs)("div",{className:"dashboard-container",children:[(0,n.jsx)("h2",{className:"dashboard-title",children:"Dashboard"}),(0,n.jsxs)("div",{className:"metrics-grid",children:[(0,n.jsxs)("div",{className:"metric-card",children:[(0,n.jsx)("div",{className:"metric-title",children:"Total Products"}),(0,n.jsx)("div",{className:"metric-value",children:s.length}),(0,n.jsxs)("div",{className:"metric-change",children:[m.toFixed(2),"% change"]})]}),(0,n.jsxs)("div",{className:"metric-card",children:[(0,n.jsx)("div",{className:"metric-title",children:"Total Sales"}),(0,n.jsxs)("div",{className:"metric-value",children:["$",t.toLocaleString()]}),(0,n.jsxs)("div",{className:"metric-change ".concat(U>=0?"":"negative"),children:[U>=0?"+":"",U.toFixed(2),"% vs last week"]})]}),(0,n.jsxs)("div",{className:"metric-card",children:[(0,n.jsx)("div",{className:"metric-title",children:"Total Delivered Sales"}),(0,n.jsx)("div",{className:"metric-value",children:l.toLocaleString()}),(0,n.jsxs)("div",{className:"metric-change ".concat(K>=0?"":"negative"),children:[K>=0?"+":"",K.toFixed(2),"% vs last week"]})]}),(0,n.jsxs)("div",{className:"metric-card",children:[(0,n.jsx)("div",{className:"metric-title",children:"Total Orders"}),(0,n.jsx)("div",{className:"metric-value",children:O.toLocaleString()}),(0,n.jsxs)("div",{className:"metric-change ".concat(B>=0?"":"negative"),children:[B>=0?"+":"",B.toFixed(2),"% vs last week"]})]}),(0,n.jsxs)("div",{className:"metric-card",children:[(0,n.jsx)("div",{className:"metric-title",children:"Total Visitors"}),(0,n.jsx)("div",{className:"metric-value",children:M.toLocaleString()}),(0,n.jsxs)("div",{className:"metric-change ".concat(W>=0?"":"negative"),children:[W>=0?"+":"",W.toFixed(2),"% vs last week"]})]})]}),(0,n.jsxs)("div",{className:"revenue-analytics",children:[(0,n.jsxs)("div",{className:"revenue-analytics-header",children:[(0,n.jsx)("div",{className:"revenue-analytics-title",children:"Revenue Analytics"}),(0,n.jsx)("select",{className:"time-range-selector-enhanced",value:Z,onChange:e=>{const s=parseInt(e.target.value,10);_(s)},children:F.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsx)(j.u,{width:"100%",height:250,children:(0,n.jsxs)(g.b,{data:je,children:[(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#ff8042",stopOpacity:.8}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#ffbb28",stopOpacity:.2})]}),(0,n.jsxs)("linearGradient",{id:"colorOrders",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#ffbb28",stopOpacity:.8}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#ff8042",stopOpacity:.2})]}),(0,n.jsx)("filter",{id:"shadow",height:"130%",children:(0,n.jsx)("feDropShadow",{dx:"0",dy:"0",stdDeviation:"3",floodColor:"#888",floodOpacity:"0.5"})})]}),(0,n.jsx)(v.d,{strokeDasharray:"3 3"}),(0,n.jsx)(y.W,{dataKey:"date"}),(0,n.jsx)(N.h,{}),(0,n.jsx)(b.m,{content:(0,n.jsx)(I,{})}),(0,n.jsx)(f.s,{}),(0,n.jsx)(C.N,{type:"monotone",dataKey:"revenue",stroke:"url(#colorRevenue)",strokeWidth:4,dot:{stroke:"#ffbb28",strokeWidth:3,r:6,fill:"#ff8042"},activeDot:{r:10,stroke:"#ffbb28",strokeWidth:3,fill:"#ff8042"},animationDuration:2e3,animationEasing:"ease-in-out",filter:"url(#shadow)"}),(0,n.jsx)(C.N,{type:"monotone",dataKey:"orders",stroke:"url(#colorOrders)",strokeDasharray:"5 5",strokeWidth:4,dot:{stroke:"#ff8042",strokeWidth:3,r:6,fill:"#ffbb28"},activeDot:{r:10,stroke:"#ff8042",strokeWidth:3,fill:"#ffbb28"},animationDuration:2e3,animationEasing:"ease-in-out",filter:"url(#shadow)"})]})})]}),(0,n.jsxs)("div",{className:"progress-section",children:[(0,n.jsxs)("div",{className:"progress-card",children:[(0,n.jsx)("h3",{className:"progress-title",children:"Active Users"}),(0,n.jsx)("div",{className:"progress-value",children:te.toLocaleString()}),(0,n.jsxs)("div",{className:"progress-change ".concat(ae>=0?"":"negative"),children:[ae>=0?"+":"",ae.toFixed(2),"% from last month"]}),ne.map((e,s)=>(0,n.jsxs)("div",{className:"progress-item",children:[(0,n.jsxs)("div",{className:"progress-label",children:[(0,n.jsx)("span",{className:"progress-label-text",children:e.country}),(0,n.jsxs)("span",{className:"progress-label-percent",children:[e.percent,"%"]})]}),(0,n.jsx)("div",{className:"progress-bar-container",children:(0,n.jsx)("div",{className:"progress-bar",style:{width:"".concat(e.percent,"%")}})})]},e.country))]}),(0,n.jsxs)("div",{className:"progress-card",children:[(0,n.jsx)("h3",{className:"progress-title",children:"Monthly Target"}),(0,n.jsxs)("div",{className:"progress-value",children:[xe.toFixed(0),"%"]}),(0,n.jsxs)("div",{className:"progress-change ".concat(ee.change>=0?"":"negative"),children:[ee.change>=0?"+":"",ee.change.toFixed(2),"% from last month"]}),(0,n.jsxs)("div",{className:"progress-message",children:["Great Progress! \ud83c\udf89",(0,n.jsx)("br",{}),"Our achievement increased by $200,000; let's reach 100% next month."]}),(0,n.jsxs)("div",{className:"target-container",children:[(0,n.jsxs)("div",{className:"target-item",children:[(0,n.jsx)("div",{children:"Target"}),(0,n.jsxs)("div",{className:"target-value",children:["$",ee.target.toLocaleString()]})]}),(0,n.jsxs)("div",{className:"target-item",children:[(0,n.jsx)("div",{children:"Revenue"}),(0,n.jsxs)("div",{className:"target-value",children:["$",ee.revenue.toLocaleString()]})]})]})]})]}),(0,n.jsx)("div",{className:"conversion-grid",children:le.map(e=>(0,n.jsxs)("div",{className:"conversion-item",children:[(0,n.jsx)("div",{className:"conversion-value",children:e.value.toLocaleString()}),(0,n.jsx)("div",{className:"conversion-label",children:e.name}),(0,n.jsxs)("div",{className:"conversion-change ".concat(e.change>=0?"positive":"negative"),children:[e.change>=0?"+":"",e.change,"%"]})]},e.name))}),(0,n.jsxs)("div",{className:"charts-row",children:[(0,n.jsxs)("div",{className:"pie-chart-container",children:[(0,n.jsx)("h3",{className:"chart-title",children:"Top Categories"}),(0,n.jsx)(j.u,{width:"100%",height:200,children:(0,n.jsx)(A.r,{children:(0,n.jsx)(S.F,{data:oe,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:70,fill:"#ff8042",label:!0,children:oe.map((e,s)=>(0,n.jsx)(P.f,{fill:k[s%k.length]},"cell-".concat(s)))})})}),(0,n.jsx)("div",{className:"categories-list",children:oe.map(e=>(0,n.jsxs)("div",{className:"category-item",children:[(0,n.jsx)("div",{children:e.name}),(0,n.jsxs)("div",{children:["$",e.value.toLocaleString()]})]},e.name))})]}),(0,n.jsxs)("div",{className:"bar-chart-container",children:[(0,n.jsx)("h3",{className:"chart-title",children:"Traffic Sources"}),(0,n.jsx)(j.u,{width:"100%",height:200,children:(0,n.jsxs)(w.E,{data:he,children:[(0,n.jsx)(D.y,{dataKey:"value",fill:"#ff8042"}),(0,n.jsx)(y.W,{dataKey:"name"}),(0,n.jsx)(N.h,{}),(0,n.jsx)(b.m,{content:(0,n.jsx)(I,{})})]})}),(0,n.jsx)("div",{className:"traffic-list",children:he.map(e=>(0,n.jsxs)("div",{className:"traffic-item",children:[(0,n.jsx)("div",{children:e.name}),(0,n.jsxs)("div",{children:[e.value,"%"]})]},e.name))})]})]})]})},E=e=>{let{onClose:s,onSave:t,initialData:r}=e;const[i,d]=(0,a.useState)(""),[l,c]=(0,a.useState)(""),[o,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[j,g]=(0,a.useState)([]),[v,y]=(0,a.useState)("");(0,a.useEffect)(()=>{r&&(d(r.title||""),c(r.description||""),p(r.imageUrl||""),x(r.buttonText||""),g(r.tags||[]))},[r]);return(0,n.jsx)("div",{className:"banner-form-overlay",children:(0,n.jsxs)("div",{className:"banner-form-container",children:[(0,n.jsx)("h2",{children:r?"Edit Banner":"Add New Banner"}),(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i&&l)try{if(o){const e=new FormData;e.append("image",o);const s=await fetch("http://localhost:5000/api/upload",{method:"POST",body:e});if(!s.ok)throw new Error("Failed to upload image");const r=await s.json(),a={title:i,description:l,buttonText:m,tags:j,imageUrl:r.imageUrl};t(a)}else{if(!h)return void alert("Please either upload an image or provide an image URL.");t({title:i,description:l,buttonText:m,tags:j,imageUrl:h})}}catch(s){console.error("Error saving banner:",s),alert("Failed to save banner. Please try again.")}else alert("Please fill in all required fields.")},className:"banner-form",children:[(0,n.jsxs)("label",{children:["Title",(0,n.jsx)("span",{className:"required",children:"*"}),":",(0,n.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),required:!0})]}),(0,n.jsxs)("label",{children:["Description",(0,n.jsx)("span",{className:"required",children:"*"}),":",(0,n.jsx)("textarea",{value:l,onChange:e=>c(e.target.value),required:!0})]}),(0,n.jsxs)("label",{children:["Image Upload",!r&&(0,n.jsx)("span",{className:"required",children:"*"}),":",(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:e=>u(e.target.files[0]),required:!r}),h&&!o&&(0,n.jsxs)("div",{className:"current-image",children:[(0,n.jsx)("p",{children:"Current image:"}),(0,n.jsx)("img",{src:h,alt:"Current banner",style:{width:"100px",height:"60px",objectFit:"cover"}})]})]}),(0,n.jsxs)("label",{children:["Button Text:",(0,n.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value)})]}),(0,n.jsxs)("label",{children:["Tags:",(0,n.jsxs)("div",{className:"tags-input-container",children:[(0,n.jsx)("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"Add a tag"}),(0,n.jsx)("button",{type:"button",className:"btn-add-tag",onClick:()=>{const e=v.trim();e&&!j.includes(e)&&(g([...j,e]),y(""))},children:"+"})]}),(0,n.jsx)("div",{className:"tags-list",children:j.map(e=>(0,n.jsxs)("span",{className:"tag-item",onClick:()=>alert("Search for tag: ".concat(e)),children:[e," \xd7",(0,n.jsx)("button",{type:"button",className:"btn-remove-tag",onClick:()=>{return s=e,void g(j.filter(e=>e!==s));var s},children:"x"})]},e))})]}),(0,n.jsxs)("div",{className:"banner-form-buttons",children:[(0,n.jsx)("button",{type:"submit",className:"btn-save",children:r?"Update":"Save"}),(0,n.jsx)("button",{type:"button",className:"btn-cancel",onClick:s,children:"Cancel"})]})]})]})})},O=()=>{const[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(!1),[d,l]=(0,a.useState)(null),[c,o]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{p()},[]);const p=async()=>{try{o(!0);const e=await i.A.get("http://localhost:5000/api/banner");s(e.data),h(null)}catch(e){console.error("Error fetching banners:",e),h("Failed to load banners")}finally{o(!1)}};return c?(0,n.jsx)("div",{className:"loading",children:"Loading banners..."}):u?(0,n.jsx)("div",{className:"error",children:u}):(0,n.jsxs)("div",{className:"banner-management-container",children:[(0,n.jsx)("h1",{children:"Banner Management"}),(0,n.jsx)("div",{className:"banner-actions",children:(0,n.jsx)("button",{className:"btn-add-banner",onClick:()=>{l(null),r(!0)},children:"Add New Banner"})}),t&&(0,n.jsx)(E,{onClose:()=>{r(!1),l(null)},onSave:d?async e=>{try{await i.A.patch("http://localhost:5000/api/banner/".concat(d.id),e),l(null),p()}catch(s){console.error("Error updating banner:",s),alert("Failed to update banner. Please check if the backend server is running.")}}:async e=>{try{await i.A.post("http://localhost:5000/api/banner",e),r(!1),p()}catch(s){console.error("Error adding banner:",s),alert("Failed to add banner")}},initialData:d}),(0,n.jsxs)("div",{className:"banners-list",children:[(0,n.jsxs)("h2",{children:["Current Banners (",e.length,")"]}),0===e.length?(0,n.jsx)("p",{children:"No banners found. Add your first banner!"}):(0,n.jsx)("div",{className:"banners-grid",children:e.map(e=>{var s;return(0,n.jsxs)("div",{className:"banner-card",children:[(0,n.jsx)("img",{src:e.imageUrl,alt:e.title,className:"banner-preview",onError:e=>{e.target.src="/images/banner/default.jpg"}}),(0,n.jsxs)("div",{className:"banner-info",children:[(0,n.jsx)("h3",{children:e.title}),(0,n.jsx)("p",{children:e.description}),(0,n.jsx)("div",{className:"banner-tags",children:null===(s=e.tags)||void 0===s?void 0:s.map((e,s)=>(0,n.jsx)("span",{className:"tag",children:e},s))})]}),(0,n.jsxs)("div",{className:"banner-actions",children:[(0,n.jsx)("button",{className:"btn-edit",onClick:()=>(e=>{l(e),r(!0)})(e),children:"Edit"}),(0,n.jsx)("button",{className:"btn-delete",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this banner?"))try{await i.A.delete("http://localhost:5000/api/banner/".concat(e)),p()}catch(s){console.error("Error deleting banner:",s),alert("Failed to delete banner")}})(e.id),children:"Delete"})]})]},e.id)})})]})]})},L=e=>{let{product:s,onClose:t,onUpdate:d}=e;const[l,c]=(0,a.useState)({name:"",description:"",price:"",previousPrice:"",stock:"",maxBuyers:"",maxPerPerson:"",tier:"Cheap",status:"Active",imageUrl:"",images:[],videos:[],tags:[],categories:[]}),[o,u]=(0,a.useState)(!1),[h,p]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[j,g]=(0,a.useState)(""),v=["Fashion","Electronics","Home & Garden","Books","Sports & Outdoors","Health & Beauty","Food & Grocery","Toys & Games","Automotive"].filter(Boolean);(0,a.useEffect)(()=>{s&&c({name:s.name||"",description:s.description||"",price:s.price||"",previousPrice:s.previousPrice||"",stock:s.stock||"",maxBuyers:s.maxBuyers||"",maxPerPerson:s.maxPerPerson||"",tier:s.tier||"Cheap",status:s.status||"Active",imageUrl:s.imageUrl||"",images:Array.isArray(s.images)?s.images:[],videos:Array.isArray(s.videos)?s.videos:[],tags:Array.isArray(s.tags)?s.tags:[],categories:Array.isArray(s.categories)?s.categories:[]})},[s]);const y=e=>{c((0,r.A)((0,r.A)({},l),{},{[e.target.name]:e.target.value}))},N=()=>{const e=h.trim();e&&!l.tags.includes(e)&&(c(s=>(0,r.A)((0,r.A)({},s),{},{tags:[...s.tags,e]})),p(""))},b=()=>{const e=j.trim();e&&!l.videos.includes(e)&&(c(s=>(0,r.A)((0,r.A)({},s),{},{videos:[...s.videos,e]})),g(""))};return s?(0,n.jsx)("div",{className:"modal-overlay",onClick:t,children:(0,n.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsxs)("h2",{children:["Edit Product: ",s.name]}),(0,n.jsx)("button",{className:"close-button",onClick:t,children:"\xd7"})]}),(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l.name&&l.description&&l.price&&l.stock){u(!0);try{await i.A.put("http://localhost:5000/api/products/".concat(s.id),{name:l.name,description:l.description,price:parseFloat(l.price),previousPrice:l.previousPrice?parseFloat(l.previousPrice):null,stock:parseInt(l.stock,10),maxBuyers:l.maxBuyers?parseInt(l.maxBuyers,10):null,maxPerPerson:l.maxPerPerson?parseInt(l.maxPerPerson,10):null,tier:l.tier,status:l.status,imageUrl:l.imageUrl,images:l.images,videos:l.videos,tags:l.tags,categories:l.categories}),d(),t()}catch(r){console.error("Error updating product:",r),alert("Failed to update product. Please try again.")}finally{u(!1)}}else alert("Name, description, price, and stock are required")},className:"product-form",children:[(0,n.jsxs)("div",{className:"form-section",children:[(0,n.jsx)("h3",{children:"Basic Information"}),(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Product Name"}),(0,n.jsx)("input",{type:"text",name:"name",value:l.name,onChange:y,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Product ID"}),(0,n.jsx)("input",{type:"text",value:s.id,disabled:!0,className:"disabled-input"})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Description"}),(0,n.jsx)("textarea",{name:"description",value:l.description,onChange:y,rows:"3",required:!0})]}),(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Previous Price ($)"}),(0,n.jsx)("input",{type:"number",name:"previousPrice",value:l.previousPrice,onChange:y,step:"0.01"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Price ($)"}),(0,n.jsx)("input",{type:"number",name:"price",value:l.price,onChange:y,step:"0.01",required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Stock"}),(0,n.jsx)("input",{type:"number",name:"stock",value:l.stock,onChange:y,required:!0})]})]}),(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Max Buyers"}),(0,n.jsx)("input",{type:"number",name:"maxBuyers",value:l.maxBuyers,onChange:y,placeholder:"Leave blank for Unlimited"}),(0,n.jsx)("div",{style:{marginTop:"5px",fontSize:"12px",color:"#666"},children:l.stock?"Only ".concat(l.stock," left in stock"):"Out of stock"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Max Per Person"}),(0,n.jsx)("input",{type:"number",name:"maxPerPerson",value:l.maxPerPerson,onChange:y,placeholder:"Leave blank for Unlimited"}),(0,n.jsxs)("div",{style:{marginTop:"5px",fontSize:"12px",color:"#666"},children:["Max Per Person: ",l.maxPerPerson||0===l.maxPerPerson?l.maxPerPerson:"Unlimited"]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Tier"}),(0,n.jsxs)("select",{name:"tier",value:l.tier,onChange:y,required:!0,children:[(0,n.jsx)("option",{value:"Cheap",children:"Cheap"}),(0,n.jsx)("option",{value:"Medium",children:"Medium"}),(0,n.jsx)("option",{value:"Premium",children:"Premium"})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Status"}),(0,n.jsx)("select",{name:"status",value:l.status,onChange:y,required:!0,children:["Active","Draft","Scheduled"].map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]})]})]}),(0,n.jsxs)("div",{className:"form-section",children:[(0,n.jsx)("h3",{children:"Images"}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Main Image"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const s=e.target.files[0];if(!s)return;const t=new FormData;t.append("image",s);try{const e=await i.A.post("http://localhost:5000/api/upload",t,{headers:{"Content-Type":"multipart/form-data"}});c(s=>(0,r.A)((0,r.A)({},s),{},{imageUrl:e.data.imageUrl}))}catch(a){console.error("Error uploading image:",a),alert("Failed to upload image. Please try again.")}}}),l.imageUrl&&(0,n.jsx)("img",{src:l.imageUrl,alt:"Main preview",className:"image-preview"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Additional Images (Multiple)"}),(0,n.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:async e=>{const s=Array.from(e.target.files);if(s.length){u(!0);try{const e=[];for(const t of s){const s=new FormData;s.append("image",t);const r=await i.A.post("http://localhost:5000/api/upload",s,{headers:{"Content-Type":"multipart/form-data"}});e.push(r.data.imageUrl)}c(s=>(0,r.A)((0,r.A)({},s),{},{images:[...s.images,...e]}))}catch(t){console.error("Error uploading images:",t),alert("Failed to upload some images. Please try again.")}finally{u(!1)}}},disabled:o}),(0,n.jsx)("div",{className:"images-grid",children:l.images&&l.images.map((e,s)=>(0,n.jsxs)("div",{className:"image-item",children:[(0,n.jsx)("img",{src:e,alt:"Additional ".concat(s+1)}),(0,n.jsx)("button",{type:"button",className:"remove-image",onClick:()=>{return e=s,void c(s=>(0,r.A)((0,r.A)({},s),{},{images:s.images.filter((s,t)=>t!==e)}));var e},children:"\xd7"})]},s))})]})]}),(0,n.jsxs)("div",{className:"form-section",children:[(0,n.jsx)("h3",{children:"Videos"}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Add Video Links (YouTube, Vimeo, etc.)"}),(0,n.jsxs)("div",{className:"input-with-button",children:[(0,n.jsx)("input",{type:"url",placeholder:"https://youtube.com/watch?v=...",value:j,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),b())}}),(0,n.jsx)("button",{type:"button",onClick:b,children:"Add Video"})]}),(0,n.jsx)("div",{className:"videos-list",children:l.videos&&l.videos.map((e,s)=>(0,n.jsxs)("div",{className:"video-item",children:[(0,n.jsx)("span",{children:e}),(0,n.jsx)("button",{type:"button",className:"remove-video",onClick:()=>{return s=e,void c(e=>(0,r.A)((0,r.A)({},e),{},{videos:e.videos.filter(e=>e!==s)}));var s},children:"\xd7"})]},s))})]})]}),(0,n.jsxs)("div",{className:"form-section",children:[(0,n.jsx)("h3",{children:"Categories & Tags"}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Categories"}),(0,n.jsxs)("div",{className:"input-with-button",children:[(0,n.jsx)("input",{type:"text",placeholder:"Enter category",value:m,onChange:e=>x(e.target.value),list:"categorySuggestions"}),(0,n.jsx)("datalist",{id:"categorySuggestions",children:v.map((e,s)=>(0,n.jsx)("option",{value:e},s))}),(0,n.jsx)("button",{type:"button",onClick:()=>{var e;(e=m)&&!l.categories.includes(e)&&(c(s=>(0,r.A)((0,r.A)({},s),{},{categories:[...s.categories,e]})),x(""))},children:"Add Category"})]}),(0,n.jsx)("div",{className:"categories-list",children:l.categories&&l.categories.map((e,s)=>(0,n.jsxs)("span",{className:"category-tag",children:[e,(0,n.jsx)("button",{type:"button",onClick:()=>{return s=e,void c(e=>(0,r.A)((0,r.A)({},e),{},{categories:e.categories.filter(e=>e!==s)}));var s},children:"\xd7"})]},s))})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Tags"}),(0,n.jsxs)("div",{className:"input-with-button",children:[(0,n.jsx)("input",{type:"text",placeholder:"Enter tag",value:h,onChange:e=>p(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),N())}}),(0,n.jsx)("button",{type:"button",onClick:N,children:"Add Tag"})]}),(0,n.jsx)("div",{className:"tags-list",children:l.tags&&l.tags.map((e,s)=>(0,n.jsxs)("span",{className:"tag-item",children:[e,(0,n.jsx)("button",{type:"button",onClick:()=>{return s=e,void c(e=>(0,r.A)((0,r.A)({},e),{},{tags:e.tags.filter(e=>e!==s)}));var s},children:"\xd7"})]},s))})]})]}),(0,n.jsxs)("div",{className:"form-actions",children:[(0,n.jsx)("button",{type:"button",onClick:t,className:"cancel-button",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",disabled:o,className:"save-button",children:o?"Saving...":"Save Changes"})]})]})]})}):null};t(7360);const T=()=>(0,n.jsx)("span",{className:"icon",children:"\ud83d\udd04"}),q=()=>(0,n.jsx)("span",{className:"icon",children:"\u2795"}),B=()=>(0,n.jsx)("span",{className:"icon",children:"\ud83d\udd0d"}),$=()=>(0,n.jsx)("span",{className:"icon",children:"\ud83d\udc41\ufe0f"}),M=()=>{const[e,s]=(0,a.useState)("products"),[t,o]=(0,a.useState)([]),[j,g]=(0,a.useState)({name:"",description:"",price:"",previousPrice:"",stock:"",maxBuyers:"",maxPerPerson:"",tier:"Cheap",status:"Active",imageUrls:[],videos:[],tags:[],categories:[]}),[v,y]=(0,a.useState)([]),[N,b]=(0,a.useState)([]),[f,C]=(0,a.useState)(""),[A,S]=(0,a.useState)(!1),[P,w]=(0,a.useState)(null),[D,I]=(0,a.useState)(!1),[k,F]=(0,a.useState)(""),[E,M]=(0,a.useState)([]);(0,a.useEffect)(()=>{if(k){const e=k.toLowerCase(),s=t.filter(s=>s.id&&s.id.toLowerCase().includes(e)||s.name&&s.name.toLowerCase().includes(e));M(s)}else M(t)},[k,t]);const R=["Fashion","Electronics","Home & Garden","Books","Sports & Outdoors","Health & Beauty","Food & Grocery","Toys & Games","Automotive"].filter(Boolean),[H,Q]=(0,a.useState)(""),[W,z]=(0,a.useState)([]),[K,V]=(0,a.useState)(!1),G=()=>{let e;const s=new Set(t&&t.length>0?t.map(e=>e.id):[]);do{e=Math.floor(1e5+9e5*Math.random()).toString()}while(s.has(e));return e};(0,a.useEffect)(()=>{if(A){const e=G();C(e)}},[A]);const J=e=>{e&&!j.categories.includes(e)&&(g(s=>(0,r.A)((0,r.A)({},s),{},{categories:[...s.categories,e]})),Q(""),V(!1))},[Y,X]=(0,a.useState)(""),[Z,_]=(0,a.useState)(""),ee=()=>{const e=Y.trim();e&&!j.tags.includes(e)&&(g(s=>(0,r.A)((0,r.A)({},s),{},{tags:[...s.tags,e]})),X(""))},se=()=>{const e=Z.trim();e&&!j.videos.includes(e)&&(g(s=>(0,r.A)((0,r.A)({},s),{},{videos:[...s.videos,e]})),_(""))},[te,re]=(0,a.useState)(""),[ae,ie]=(0,a.useState)("Active"),[ne,de]=(0,a.useState)(()=>"true"===localStorage.getItem("adminIsAuthenticated")),[le,ce]=(0,a.useState)({username:"",password:""}),[oe,ue]=(0,a.useState)("");(0,a.useEffect)(()=>{ne?(localStorage.setItem("adminIsAuthenticated","true"),he(),pe(),me(),Ie()):localStorage.removeItem("adminIsAuthenticated")},[ne]);const he=async()=>{try{const e=await i.A.get("http://localhost:5000/api/products");console.log("Fetched products:",e.data),o(e.data)}catch(e){console.error("Error fetching products:",e)}},pe=async()=>{try{const e=await i.A.get("http://localhost:5000/api/users");console.log("Fetched users:",e.data),y(e.data)}catch(e){console.error("Error fetching users:",e)}},me=async()=>{try{const e=await i.A.get("http://localhost:5000/api/messages");console.log("Fetched messages:",e.data),b(e.data)}catch(e){console.error("Error fetching messages:",e)}},[xe,je]=(0,a.useState)([]),[ge,ve]=(0,a.useState)([]),[ye,Ne]=(0,a.useState)([]),[be,fe]=(0,a.useState)([]),[Ce,Ae]=(0,a.useState)([]),[Se,Pe]=(0,a.useState)([]),[we,De]=(0,a.useState)([]),Ie=async()=>{try{const e=await i.A.get("http://localhost:5000/api/orders");console.log("Fetched orders:",e.data),je(e.data);const s=e.data.filter(e=>"pending"===e.status.toLowerCase()||"processing"===e.status.toLowerCase()),t=e.data.filter(e=>"confirmed"===e.status.toLowerCase()),r=e.data.filter(e=>"canceled"===e.status.toLowerCase()),a=e.data.filter(e=>["returned","cancelled","cancel"].includes(e.status.toLowerCase())),n=e.data.filter(e=>"shipping"===e.status.toLowerCase()||"shipped"===e.status.toLowerCase()),d=e.data.filter(e=>"delivered"===e.status.toLowerCase());ve(s),Ne(t),fe(r),Ae(a),Pe(n),De(d)}catch(e){console.error("Error fetching orders:",e)}};(0,a.useEffect)(()=>{he()},[]);const ke=e=>{g((0,r.A)((0,r.A)({},j),{},{[e.target.name]:e.target.value}))},Fe=e=>{ce((0,r.A)((0,r.A)({},le),{},{[e.target.name]:e.target.value}))},Ue=e=>{e.preventDefault();const{username:s,password:t}=le;"Anime-spring"===s&&"gHost-oF-the-maRket"===t?(de(!0),ue("")):ue("Invalid username or password")};return ne?(0,n.jsxs)("div",{className:"admin-panel-container admin-panel-layout",children:[(0,n.jsx)(d,{activeSection:e,onSectionChange:e=>{s(e);const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})},onLogout:()=>{de(!1),localStorage.removeItem("adminIsAuthenticated"),ce({username:"",password:""})}}),(0,n.jsxs)("main",{className:"main-content",children:["dashboard"===e&&(0,n.jsx)(U,{products:t}),"products"===e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{id:"products",children:"Products"}),(0,n.jsxs)("div",{className:"product-list-header",children:[(0,n.jsx)("h2",{children:"Products list"}),(0,n.jsxs)("div",{className:"product-list-actions",children:[(0,n.jsxs)("button",{className:"btn-filter",children:[(0,n.jsx)(B,{})," Filter"]}),(0,n.jsxs)("button",{className:"btn-see-all",children:[(0,n.jsx)($,{})," See All"]}),(0,n.jsxs)("button",{className:"btn-add",onClick:()=>S(!A),children:[(0,n.jsx)(q,{})," Add Product"]})]})]}),(0,n.jsx)("div",{className:"search-container",children:(0,n.jsx)("input",{type:"text",placeholder:"Search by product ID or name...",value:k,onChange:e=>F(e.target.value),className:"search-input"})}),A&&(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),j.name&&j.description&&j.price&&j.stock)try{const e=j.imageUrls&&j.imageUrls.length>0?j.imageUrls[0]:"";await i.A.post("http://localhost:5000/api/products",{id:f,name:j.name,description:j.description,price:parseFloat(j.price),previousPrice:j.previousPrice?parseFloat(j.previousPrice):null,stock:parseInt(j.stock,10),maxBuyers:j.maxBuyers?parseInt(j.maxBuyers,10):null,maxPerPerson:j.maxPerPerson?parseInt(j.maxPerPerson,10):null,tier:j.tier,status:j.status,imageUrl:e,images:j.imageUrls,videos:j.videos,tags:j.tags,categories:j.categories}),g({name:"",description:"",price:"",previousPrice:"",stock:"",maxBuyers:"",maxPerPerson:"",tier:"Cheap",status:"Active",imageUrls:[],tags:[],categories:[]}),C(""),re(""),ie("Active"),he()}catch(s){console.error("Error adding product:",s),s.response&&(console.error("Response data:",s.response.data),console.error("Response status:",s.response.status),console.error("Response headers:",s.response.headers)),alert("Failed to add product. Please try again.")}else alert("Name, description, price, and stock are required")},className:"admin-form",children:[(0,n.jsx)("input",{type:"text",name:"name",placeholder:"Product Name",value:j.name,onChange:ke,required:!0}),(0,n.jsx)("input",{type:"text",name:"productId",placeholder:"Product ID",value:f||"",disabled:!0,readOnly:!0,style:{backgroundColor:"#e0e0e0",cursor:"not-allowed"}}),(0,n.jsxs)("button",{type:"button",onClick:()=>{const e=G();C(e)},style:{marginBottom:"10px"},children:[(0,n.jsx)(T,{})," Regenerate ID"]}),(0,n.jsx)("input",{type:"text",name:"description",placeholder:"Description",value:j.description,onChange:ke,required:!0}),(0,n.jsx)("input",{type:"number",name:"previousPrice",placeholder:"Previous Price",value:j.previousPrice,onChange:ke,step:"0.01"}),(0,n.jsx)("input",{type:"number",name:"price",placeholder:"Price",value:j.price,onChange:ke,step:"0.01",required:!0}),(0,n.jsx)("input",{type:"number",name:"maxBuyers",placeholder:"Max Buyers (e.g. 10)",value:j.maxBuyers,onChange:ke}),(0,n.jsx)("div",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:j.stock?"Only ".concat(j.stock," left in stock"):"Out of stock"}),(0,n.jsx)("input",{type:"number",name:"maxPerPerson",placeholder:"Max Per Person (e.g. 10)",value:j.maxPerPerson,onChange:ke}),(0,n.jsxs)("div",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:["Max Per Person: ",j.maxPerPerson?j.maxPerPerson:"Unlimited"]}),(0,n.jsxs)("select",{name:"tier",value:j.tier,onChange:ke,required:!0,children:[(0,n.jsx)("option",{value:"Cheap",children:"Cheap"}),(0,n.jsx)("option",{value:"Medium",children:"Medium"}),(0,n.jsx)("option",{value:"Premium",children:"Premium"})]}),(0,n.jsx)("input",{type:"number",name:"stock",placeholder:"Stock",value:te,onChange:e=>{re(e.target.value),g(s=>(0,r.A)((0,r.A)({},s),{},{stock:e.target.value}))},required:!0}),(0,n.jsx)("select",{name:"status",value:ae,onChange:e=>{ie(e.target.value),g(s=>(0,r.A)((0,r.A)({},s),{},{status:e.target.value}))},required:!0,children:["Active","Draft","Scheduled"].map(e=>(0,n.jsx)("option",{value:e,children:e},e))}),(0,n.jsx)("input",{type:"file",name:"imageFiles",accept:"image/*",multiple:!0,onChange:async e=>{const s=Array.from(e.target.files);if(!s.length)return;const t=[];for(const r of s){const e=new FormData;e.append("image",r);try{const s=await i.A.post("http://localhost:5000/api/upload",e,{headers:{"Content-Type":"multipart/form-data"}});t.push(s.data.imageUrl)}catch(a){console.error("Error uploading image:",a),alert("Failed to upload image: ".concat(r.name,". Please try again."))}}t.length>0&&g(e=>(0,r.A)((0,r.A)({},e),{},{imageUrls:[...e.imageUrls,...t]}))}}),(0,n.jsx)("div",{className:"image-previews",children:j.imageUrls&&j.imageUrls.map((e,s)=>(0,n.jsxs)("div",{className:"image-preview-item",children:[(0,n.jsx)("img",{src:e,alt:"Preview ".concat(s+1),className:"image-preview"}),(0,n.jsx)("button",{type:"button",className:"remove-image-button",onClick:()=>{return e=s,void g(s=>(0,r.A)((0,r.A)({},s),{},{imageUrls:s.imageUrls.filter((s,t)=>t!==e)}));var e},children:"\xd7"})]},s))}),(0,n.jsxs)("div",{className:"category-input-container",children:[(0,n.jsx)("input",{type:"text",placeholder:"Enter category",value:H,onChange:e=>{const s=e.target.value;if(Q(s),s.length>0){const e=R.filter(e=>e.toLowerCase().includes(s.toLowerCase())&&!j.categories.includes(e));z(e),V(!0)}else V(!1)},onFocus:()=>V(H.length>0),onBlur:()=>setTimeout(()=>V(!1),200),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),J(H))}}),(0,n.jsxs)("button",{type:"button",onClick:()=>J(H),children:[(0,n.jsx)(q,{})," Add Category"]}),K&&W.length>0&&(0,n.jsx)("div",{className:"category-suggestions",children:W.map((e,s)=>(0,n.jsx)("div",{className:"suggestion-item",onClick:()=>{J(e)},children:e},s))})]}),(0,n.jsx)("div",{className:"categories-list",children:j.categories&&j.categories.map((e,s)=>(0,n.jsxs)("span",{className:"category-item",children:[e,(0,n.jsx)("button",{type:"button",className:"remove-category-button",onClick:()=>{return s=e,void g(e=>(0,r.A)((0,r.A)({},e),{},{categories:e.categories.filter(e=>e!==s)}));var s},children:"x"})]},s))}),(0,n.jsxs)("div",{className:"tags-input-container",children:[(0,n.jsx)("input",{type:"text",name:"tagInput",placeholder:"Enter tag",value:Y,onChange:e=>{X(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),ee())}}),(0,n.jsxs)("button",{type:"button",onClick:ee,children:[(0,n.jsx)(q,{})," Add Tag"]})]}),(0,n.jsx)("div",{className:"tags-list",children:j.tags&&j.tags.map((e,s)=>(0,n.jsxs)("span",{className:"tag-item",children:[e,(0,n.jsx)("button",{type:"button",className:"remove-tag-button",onClick:()=>{return s=e,void g(e=>(0,r.A)((0,r.A)({},e),{},{tags:e.tags.filter(e=>e!==s)}));var s},children:"x"})]},s))}),(0,n.jsxs)("div",{className:"video-input-container",children:[(0,n.jsx)("input",{type:"text",placeholder:"Enter video URL",value:Z,onChange:e=>_(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),se())}}),(0,n.jsxs)("button",{type:"button",onClick:se,children:[(0,n.jsx)(q,{})," Add Video"]})]}),(0,n.jsx)("div",{className:"videos-list",children:j.videos&&j.videos.map((e,s)=>(0,n.jsxs)("div",{className:"video-item",children:[(0,n.jsx)("span",{children:e}),(0,n.jsx)("button",{type:"button",className:"remove-video-button",onClick:()=>{return s=e,void g(e=>(0,r.A)((0,r.A)({},e),{},{videos:e.videos.filter(e=>e!==s)}));var s},children:"x"})]},s))}),(0,n.jsxs)("button",{type:"submit",children:[(0,n.jsx)(q,{})," Add Product"]})]}),(0,n.jsxs)("table",{className:"product-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)("input",{type:"checkbox"})}),(0,n.jsx)("th",{children:"Product Name"}),(0,n.jsx)("th",{children:"Product ID"}),(0,n.jsx)("th",{children:"Category"}),(0,n.jsx)("th",{children:"Price"}),(0,n.jsx)("th",{children:"Stock"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:E&&E.map(e=>(0,n.jsxs)("tr",{className:"product-table-row",children:[(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"checkbox"})}),(0,n.jsxs)("td",{className:"product-name-cell",children:[console.log("Product imageUrl:",e.imageUrl),(0,n.jsx)("img",{src:e.imageUrl&&e.imageUrl.startsWith("http")?e.imageUrl:"".concat(window.location.origin,"/uploads/").concat(e.imageUrl),alt:e.name,className:"product-table-image"}),(0,n.jsx)("span",{children:e.name}),e.previousPrice&&e.previousPrice>e.price&&(e.previousPrice-e.price)/e.previousPrice<=.05&&(0,n.jsx)("span",{className:"elite-choice-badge",children:"Elite Choice"})]}),(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:e.categories&&e.categories.length>0?e.categories.join(", "):"No Category"}),(0,n.jsxs)("td",{children:["$",e.price?e.price.toFixed(2):"0.00",e.previousPrice&&e.previousPrice>e.price&&(0,n.jsx)("span",{className:"discount-display",children:(e.previousPrice-e.price)/e.previousPrice<=.05?"Elite Choice":"".concat(Math.round((e.previousPrice-e.price)/e.previousPrice*100),"% OFF")})]}),(0,n.jsx)("td",{children:e.stock||0}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"status-badge status-".concat((e.status||"").toLowerCase()),children:e.status||"Unknown"})}),(0,n.jsxs)("td",{children:[e.previousPrice&&e.previousPrice>e.price&&(e.previousPrice-e.price)/e.previousPrice<=.05&&(0,n.jsx)("span",{className:"elite-choice-badge",children:"Elite Choice"}),(0,n.jsx)("button",{className:"btn-details",onClick:()=>(e=>{w(e),I(!0)})(e),children:"Details"}),(0,n.jsx)("button",{className:"btn-delete",onClick:()=>(async e=>{try{await i.A.delete("http://localhost:5000/api/products/".concat(e)),he()}catch(s){console.error("Error deleting product:",s)}})(e.id),children:"Delete"})]})]},e.id))})]})]}),"users"===e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{id:"users",children:"User Data"}),(0,n.jsxs)("table",{className:"user-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Username"}),(0,n.jsx)("th",{children:"Email"}),(0,n.jsx)("th",{children:"Password"}),(0,n.jsx)("th",{children:"Number"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:v&&v.map(e=>(0,n.jsxs)("tr",{className:"user-table-row",children:[(0,n.jsx)("td",{children:e.username||"N/A"}),(0,n.jsx)("td",{children:e.email||"N/A"}),(0,n.jsx)("td",{children:e.password||"N/A"}),(0,n.jsx)("td",{children:e.phone||"N/A"}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:"btn-delete",onClick:()=>(async e=>{try{await i.A.delete("http://localhost:5000/api/users/".concat(e)),pe()}catch(s){console.error("Error deleting user:",s)}})(e.id),children:"Delete"})})]},e.id))})]})]}),"messages"===e&&(0,n.jsx)(l,{}),"orders"===e&&(0,n.jsxs)(n.Fragment,{children:[console.log("AdminPanel - Passing to Orders:",{processingOrders:ge,users:v}),(0,n.jsx)(c,{orders:ge,products:t,users:v,onOrderStatusChange:Ie})]}),"cancelorder"===e&&(0,n.jsx)(h,{orders:be,products:t,users:v}),"confirmedOrders"===e&&(0,n.jsx)(m,{products:t,users:v}),"orderhistory"===e&&(0,n.jsx)(u,{isAdmin:!0}),"deliveredorders"===e&&(0,n.jsx)(p,{products:t,orders:we,refreshOrders:Ie}),"shippedOrders"===e&&(0,n.jsx)(x,{products:t,onOrderStatusChange:Ie}),"update"===e&&(0,n.jsx)(O,{})]}),D&&P&&(0,n.jsx)(L,{product:P,onClose:()=>{w(null),I(!1)},onUpdate:()=>{he()}})]}):(0,n.jsxs)("div",{className:"admin-login-container",children:[(0,n.jsx)("h2",{children:"Admin Panel Login"}),(0,n.jsxs)("form",{onSubmit:Ue,className:"admin-login-form",children:[(0,n.jsx)("input",{type:"text",name:"username",placeholder:"Username",value:le.username,onChange:Fe,required:!0}),(0,n.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:le.password,onChange:Fe,required:!0}),oe&&(0,n.jsx)("p",{className:"login-error",children:oe}),(0,n.jsx)("button",{type:"submit",children:"Login"})]})]})}}}]);
//# sourceMappingURL=621.2b31bb4b.chunk.js.map